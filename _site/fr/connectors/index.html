
      <!DOCTYPE html>
      <html lang="">
      <head>
      <link rel="stylesheet" href="/css/connectors.css" />
      
    <link
      rel="alternate"
      hreflang="en"
      href="/en/connectors" />

<style>
.button { cursor: pointer; }
a { text-decoration: none; }
a:hover { text-decoration: underline; }

.skeleton-anim:after {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  content: "";
  background: 
    linear-gradient(0.25turn, transparent, rgba(255,255,255,.75), transparent),
    linear-gradient(transparent, transparent),
    radial-gradient(38px circle at 19px 19px, transparent 50%, transparent 51%),
    linear-gradient(transparent, transparent);  
  background-repeat: no-repeat;
  background-size: 315px 250px, 315px 180px, 100px 100px, 225px 30px; 
  background-position: -315px 0, 0 0, 0px 190px, 50px 195px; 
  animation: loading 1.5s infinite;
}

@keyframes loading {  
  to {
    background-position: 200% 0, 0 0, 0 190px, 50px 195px;
  }
}

</style>
      <script src="/node_modules/vue/dist/vue.global.js"></script>
<script src="/js/main.js"></script>
<script type="module">
window.addEventListener('load', function() {
  const { createApp } = Vue;
  const { api, constants, types } = silex;
  const {
    ConnectorType,
  } = types
  const {
    connectorList,
    logout,
  } = api

  const App = {
    data() {
      return {
        connectors: [],
        error: null,
        message: null,
        loading: true,
        lastConnector: null,
      }
    },
    mounted() {
      this.init()
      window.addEventListener('message', (event) => {
        if(event.data && event.data.type === 'login') {
          this.loginResult(event.data)
        }
      })
    },

    methods: {
      async init() {
        try {
          this.loading = true
          console.log('init')
          this.connectors = await connectorList({type: ConnectorType.STORAGE})
          console.log('connectors', this.connectors)
          this.loading = false
        } catch (error) {
          console.error(error)
          this.error = error
          this.loading = false
        }
      },
      openLogin(connector) {
        this.lastConnector = connector
        const nonOAuthUrl = `${constants.API_PATH}${constants.API_CONNECTOR_PATH}${constants.API_CONNECTOR_LOGIN}?connectorId=${connector.connectorId}&type=${connector.type}`
        console.log('openLogin', connector.oauthUrl, nonOAuthUrl)
        window.open(connector.oauthUrl || nonOAuthUrl, '_blank')
      },
      loginResult(data) {
        console.log('loginResult', data)
        if(data.error) {
          this.error = data.error
          this.message = `Erreur, impossible de se connecter. ${data.message}`
        } else {
          window.location.href = '/'
        }
      },
      async logout() {
        try {
          this.message = 'DÃ©connexion en cours'
          await logout({type: ConnectorType.STORAGE, connectorId: this.lastConnector.connectorId})
          this.loggedIn = false
          this.user = null
          this.websites = []
          this.loading = false
          this.message = ''
          this.error = false
        } catch (error) {
          console.error(error)
          this.error = error
          this.message = error.message
          this.loading = false
        }
      },
    },
  };

  // Start vue app
  createApp(App).mount('.app');
})
</script>

      <title></title>
      <link rel="icon" href="" />
      <meta property="description" content=""/>
<meta property="og:title" content=""/>
<meta property="og:description" content=""/>
<meta property="og:image" content=""/>
      </head>
      <body
            id="i2hcfw"
            class=" app"
            
            
            ><A
            id="ixzhcr" href="/"
            class="button button-bar__item--secondary "
            
            
            >< Retour</A><div
            id="imgx81"
            
            
            
            ><div
            id="in62y2"
            class="button-bar "
            
            
            ><A
            id="isqe61" href="https://"
            class="h-space button-bar__item--main button-bar_item button big-button "
            v-if="!loading" v-for="(connector, index) in connectors" :key="index" :style="{ backgroundColor: connector.background, color: connector.color }" @click="openLogin(connector)"
            
            ><div
            id="i87asw"
            
            v-text="connector.displayName"
            
            >Insert your text here</div></A></div><div
            id="i9msnk"
            
            v-if="error" v-html="message"
            
            >Insert your text here</div><div
            id="i6akll"
            class="button button--tertiary "
            v-if="error" @click="logout()"
            
            >Logout</div></div></body>
      </html>
      